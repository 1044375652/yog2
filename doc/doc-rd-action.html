<h5 class=""><a name="%E6%89%A7%E8%A1%8C%E5%99%A8%E4%B8%8E%E8%B7%AF%E7%94%B1" href="#%E6%89%A7%E8%A1%8C%E5%99%A8%E4%B8%8E%E8%B7%AF%E7%94%B1">执行器与路由</a></h5><h5 class=""><a name="%E6%89%A7%E8%A1%8C%E5%99%A8" href="#%E6%89%A7%E8%A1%8C%E5%99%A8">执行器</a></h5><p>页面请求会经由路由转发至 action 处理，一般我们会在 action 中处理请求的参数，如 querystring, cookie 甚至 upload files，然后将参数处理为数据层模块需要的参数格式，调用数据层模块获取数据后，指定后端模板和数据进行页面渲染。</p>
<blockquote>
<p>action 均存放在 <code>server/action</code> 中。</p>
</blockquote>
<p>示例：</p>
<pre><code class="hljs lang-javascript"><span class="hljs-comment">// /server/action/index.js</span>
<span class="hljs-comment">//引用数据层模块</span>
<span class="hljs-keyword">var</span> indexModel = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../model/index.js'</span>);
<span class="hljs-comment">//引用一些基础库</span>
<span class="hljs-keyword">var</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../lib/util.js'</span>);

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(req, res)</span></span>{
    <span class="hljs-comment">//解析请求参数</span>
    <span class="hljs-keyword">var</span> id = req.query.id;
    indexModel.getProductByID(id, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(err, data)</span></span>{
        <span class="hljs-comment">//异常处理</span>
        <span class="hljs-keyword">if</span> (err){
            next(err);
        }
        data.time = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(); <span class="hljs-comment">//加工数据</span>
        <span class="hljs-comment">//渲染页面</span>
        res.render(<span class="hljs-string">'home/page/index.tpl'</span>, data);
    });
};
</code></pre>
