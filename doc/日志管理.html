<p>在 yog2 中，使用 <a href="https://github.com/fex-team/yog-log">yog-log</a> 来处理日志功能，yog2 的日志功能的特点在于可以准确的提供请求的 <code>LogID</code> ，方便以请求为单位对问题进行追查。</p>
<blockquote>
<p>准确提供请求级 <code>LogID</code> 的难点在于如何让各种与请求无关的模块正确的获取当前调用请求的 <code>LogID</code> ，如果使用全局变量，由于 Node.js 的异步 I/O 模型，不同请求直接的 <code>LogID</code> 会出现被覆盖的情况。 <a href="https://github.com/fex-team/yog-log">yog-log</a> 则通过 <code>domain</code> 技术来保证了不同的请求之间，可以获取到正确的 <code>LogID</code></p>
</blockquote>
<h4 class=""><a name="%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE" href="#%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE">日志配置</a></h4><p>日志配置位于 project 的 <code>/conf/plugins/log.js</code> 中。它提供的配置有</p>
<ul>
<li><p>app</p>
<p>  配置日志的 App 名称，默认为 <code>yog</code></p>
</li>
<li><p>intLevel</p>
<p>  根据值的不同，控制 Log 输出的日志级别</p>
<ul>
<li><code>1</code>   打印FATAL</li>
<li><code>2</code>   打印FATAL和WARNING</li>
<li><code>4</code>   打印FATAL、WARNING、NOTICE (线上程序正常运行时的配置)</li>
<li><code>8</code>   打印FATAL、WARNING、NOTICE、TRACE (线上程序异常时使用该配置)</li>
<li><code>16</code>  打印FATAL、WARNING、NOTICE、TRACE、DEBUG (测试环境配置)</li>
</ul>
</li>
<li><p>auto_rotate</p>
<p>  控制是否自动将日志根据小时切分，默认为 <code>1</code></p>
</li>
<li><p>debug</p>
<p>  开启 debug 后，日志将在控制台输出而不是文件中输出，默认为 <code>0</code></p>
</li>
<li><p>format 与 format_wf</p>
<p>  用于配置常规日志与错误日志的日志格式，具体参数请参考 <a href="https://github.com/fex-team/yog-log">yog-log</a></p>
</li>
<li><p>log_path</p>
<p>  Log 的存放目录</p>
</li>
</ul>
<h4 class=""><a name="yog.log" href="#yog.log">yog.log</a></h4><p><code>yog.log</code> 是用于记录日志的接口，他按照日志等级提供了多个接口</p>
<ul>
<li>yog.log.debug</li>
<li>yog.log.trace</li>
<li>yog.log.notice</li>
<li>yog.log.warning</li>
<li>yog.log.fatal</li>
</ul>
<p>使用示例：</p>
<pre><code class="hljs lang-javascript"><span class="hljs-comment">// 打印NOTICE日志</span>
yog<span class="hljs-built_in">.</span><span class="hljs-keyword">log</span><span class="hljs-built_in">.</span>notice(<span class="hljs-string">'server started'</span>);

<span class="hljs-comment">// 记录详尽的FATAL日志</span>
 yog<span class="hljs-built_in">.</span><span class="hljs-keyword">log</span><span class="hljs-built_in">.</span>fatal({
   <span class="hljs-string">'stack'</span>:e, <span class="hljs-comment">//错误堆栈</span>
   <span class="hljs-string">'errno'</span>:<span class="hljs-number">120</span>,  <span class="hljs-comment">//错误码</span>
   <span class="hljs-string">'msg'</span> :<span class="hljs-string">'error happened!'</span>,  <span class="hljs-comment">//错误消息</span>
   <span class="hljs-string">'custom'</span>:{<span class="hljs-string">'key1'</span> :<span class="hljs-string">'value1'</span>,<span class="hljs-string">'key2'</span>:<span class="hljs-string">'value2'</span>} <span class="hljs-comment">//自定义消息</span>
 });

<span class="hljs-comment">// 记录简单的FATAL日志</span>
yog<span class="hljs-built_in">.</span><span class="hljs-keyword">log</span><span class="hljs-built_in">.</span>fatal(<span class="hljs-string">'error happend!'</span>);
</code></pre>
