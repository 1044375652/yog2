<h7 class=""><a name="用户插件" class="anchor" href="#用户插件"><span class="doc-link"></span></a>用户插件</h7><p>用户插件存放在Yog项目的plugins目录中，插件是有其严格的目录规范的</p>
<pre><code>├─yog                 <span class="hljs-preprocessor"># Yog根目录</span>
  └──plugins          <span class="hljs-preprocessor"># 用户插件目录</span>
      └─userPlugins   <span class="hljs-preprocessor"># 插件目录</span>
          └─<span class="hljs-keyword">index</span>.js  <span class="hljs-preprocessor"># 插件入口</span>
</code></pre><p>其中插件入口必须在一个文件夹中，并且名称必须为index.js。</p>
<p>相应的，插件的实现也有进一步要求</p>
<pre><code class="hljs lang-javascript"><span class="hljs-built_in">module</span>.exports.userPlugins = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(app, conf)</span></span>{

}

<span class="hljs-comment">//默认配置</span>
<span class="hljs-built_in">module</span>.exports.userPlugins.defaultConf = {

}
</code></pre>
<p>app为yog.app对象，即Express的<a href="http://expressjs.com/4x/api.html#application">app</a>
conf为插件的配置项
module.exports后的属性名就是插件的真实名称</p>
<p>文件夹名称并非插件的真实名称，但是一般我们会将插件名称与文件夹名称设置为一样方便维护。因此实际上你也可以在一个index.js中编写多个插件。</p>
<pre><code class="hljs lang-javascript"><span class="hljs-built_in">module</span>.exports.userPluginsA = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(app, conf)</span></span>{

}

<span class="hljs-built_in">module</span>.exports.userPluginsB = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(app, conf)</span></span>{

}
</code></pre>
<p>插件也支持异步初始化</p>
<pre><code class="hljs lang-javascript"><span class="hljs-built_in">module</span>.exports.userPlugins = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(app, conf, cb)</span></span>{
    cb &amp;&amp; cb();
}

<span class="hljs-built_in">module</span>.exports.userPlugins.defaultConf = {

}
</code></pre>
